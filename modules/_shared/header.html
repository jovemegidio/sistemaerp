<!-- 
    ALUFORCE Header Component
    Header padrão para todos os módulos do sistema
    Inclui: Logo, Navegação, Busca, Dark Mode, Notificações, Avatar
-->

<header class="topbar">
    <link rel="icon" type="image/x-icon" href="/favicon-aluforce.webp">
    <div class="topbar-left">
        <div class="logo-section">
            <img src="/images/Logo Monocromatico - Branco - Aluforce.webp" alt="Aluforce" class="header-logo" />
        </div>
    </div>
    
    <div class="topbar-center">
        <div class="nav-icons">
            <button class="nav-icon-btn" title="Grid">
                <i class="fas fa-th"></i>
            </button>
            <button class="nav-icon-btn" title="Lista">
                <i class="fas fa-list"></i>
            </button>
            <button class="nav-icon-btn" title="Atualizar Daçãos" id="btn-refresh-header">
                <i class="fas fa-sync-alt"></i>
            </button>
            <button class="nav-icon-btn" title="Alternar Modo Escuro" id="btn-dark-mode-toggle">
                <i class="fas fa-moon" id="dark-mode-icon"></i>
            </button>
        </div>
        
        <div class="search-wrapper" role="search" aria-label="Pesquisar">
            <i class="fas fa-search search-icon" aria-hidden="true"></i>
            <input id="main-search" type="search" placeholder="Buscar..." class="search-input" autocomplete="off" aria-label="Pesquisar" />
            <div id="search-inline-results" class="search-inline-dropdown" role="listbox" aria-label="Resultados da busca" aria-live="polite" aria-hidden="true"></div>
        </div>
        
        <button class="menu-toggle-btn" title="Menu">
            <i class="fas fa-bars"></i>
        </button>
    </div>
    
    <div class="topbar-right">
        <div class="notification-icons">
            <button class="notification-btn" title="Notificações" id="notification-bell">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notification-count">0</span>
            </button>
            <button class="notification-btn" title="Mensagens">
                <i class="fas fa-envelope"></i>
            </button>
            <button class="notification-btn" title="Configurações">
                <i class="fas fa-cog"></i>
            </button>
        </div>
        
        <div class="user-menu" onclick="toggleUserMenu()">
            <span class="user-text">Carregando...</span>
            <div class="avatar-circle">
                <img src="avatars/default.webp" alt="Usuário" / onerror="this.onerror=null; this.src='/avatars/default.webp';">
            </div>
        </div>
        
        <div class="user-menu-dropdown" id="user-menu-dropdown">
            <div class="py-12">
                <a href="#" class="dropdown-menu-item">
                    <i class="fas fa-user mr-8 text-gray-400"></i>Meu Perfil
                </a>
                <a href="#" class="dropdown-menu-item">
                    <i class="fas fa-cog mr-8 text-gray-400"></i>Configurações
                </a>
                <hr class="my-8 border-0 border-t border-gray-200">
                <a href="/dashboard" id="btn-dashboard-link" class="dropdown-menu-item">
                    <i class="fas fa-home mr-8 text-gray-400"></i>Dashboard
                </a>
                <a href="#" id="btn-logout" class="dropdown-menu-item-danger">
                    <i class="fas fa-sign-out-alt mr-8"></i>Sair
                </a>
            </div>
        </div>
    </div>
</header>

<script>
    // Toggle user menu
    function toggleUserMenu() {
        const dropdown = document.getElementById('user-menu-dropdown');
        if (dropdown) {
            dropdown.classList.toggle('show');
        }
    }
    
    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
        const userMenu = document.querySelector('.user-menu');
        const dropdown = document.getElementById('user-menu-dropdown');
        if (dropdown && userMenu && !userMenu.contains(e.target)) {
            dropdown.classList.remove('show');
        }
    });
    
    // Logout button
    const logoutBtn = document.getElementById('btn-logout');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('Deseja realmente sair do sistema')) {
                // Clear auth token
                document.cookie = 'authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;';
                localStorage.clear();
                window.location.href = '/login.html';
            }
        });
    }
    
    // Dashboard link
    const dashboardLink = document.getElementById('btn-dashboard-link');
    if (dashboardLink) {
        dashboardLink.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = '/dashboard';
        });
    }
</script>
